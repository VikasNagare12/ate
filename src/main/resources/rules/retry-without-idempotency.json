{
  "id": "RETRY-IDEMPOTENCY-001",
  "name": "Retryable Methods Must Be Idempotent",
  "enabled": true,
  "severity": "ERROR",
  "confidence": "MEDIUM",
  "description": "Methods annotated with @Retryable should not call non-idempotent operations",
  "target": {
    "type": "ANNOTATED_METHOD",
    "annotation": "Retryable"
  },
"constraints": {
  "mustNotInvokeMethodsMatching": [
    ".*EmailService.*send.*",
    ".*PaymentService.*charge.*",
    ".*NotificationService.*notify.*",
    ".*MessageProducer.*send.*"
  ]
},
"rationale": {
  "why": "Retries can cause duplicate operations if not idempotent.",
  "impact": "Double charging, spam emails, duplicate messages."
},
"remediation": {
  "summary": "Ensure idempotency.",
  "options": [
    "Add deduplication keys",
    "Move side-effects out of retry block"
  ]
  },
"tags": [
  "retry",
  "idempotency",
  "resilience"
]
}
