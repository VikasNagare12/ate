{
  "id": "RETRY-IDEMPOTENCY-001",
  "name": "Retryable Methods Must Be Idempotent",
  "enabled": true,
  "severity": "ERROR",
  "confidence": "MEDIUM",
  "description": "Methods annotated with @Retryable should not call non-idempotent operations",
  "target": {
    "artifactType": "Method",
    "annotationPattern": "Retryable"
  },
  "constraints": {
    "mustNotInvokeMethodsMatching": [
      "(?i).*charge.*",
      "(?i).*pay.*",
      "(?i).*send.*",
      "(?i).*create.*",
      "(?i).*insert.*"
    ]
  },
  "rationale": {
  "why": "Retries can cause duplicate operations if not idempotent.",
  "impact": "Double charging, spam emails, duplicate messages."
},
"remediation": {
  "summary": "Ensure idempotency.",
  "options": [
    "Add deduplication keys",
    "Move side-effects out of retry block"
  ]
  }
}
