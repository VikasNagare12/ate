{
  "id": "THREAD-MGMT-001",
  "name": "Direct Thread Creation",
  "description": "You are enforcing proper thread management. A violation occurs if the code manually creates threads (e.g., new Thread(), Thread.start()) instead of using Spring's managed executors (e.g., @Async, TaskExecutor). Unmanaged threads are hard to monitor and can leak resources.",
  "severity": "ERROR",
  "category": "ASYNC_SAFETY",
  "isEnabled": true,
  "detection": {
    "entryPoints": {
      "annotations": [],
      "types": [],
      "methodPatterns": [".*"]
    },
    "sinks": {
      "annotations": [],
      "types": [
        "java.lang.Thread"
      ],
      "methodPatterns": ["<init>", "start"]
    },
    "pathConstraints": {
      "mustContain": [],
      "mustNotContain": [],
      "maxDepth": 10
    }
  },
  "remediation": {
    "quickFix": "Use @Async annotation or inject TaskExecutor/ThreadPoolTaskExecutor",
    "explanation": "Direct Thread creation bypasses Spring's lifecycle management, making threads hard to monitor, configure, and gracefully shutdown. Spring executors provide proper thread pooling, naming, and integration with actuator metrics.",
    "references": [
      "https://docs.spring.io/spring-framework/reference/integration/scheduling.html",
      "https://docs.spring.io/spring-boot/reference/features/task-execution-and-scheduling.html"
    ]
  }
}
