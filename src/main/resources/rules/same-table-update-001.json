{
  "id": "SAME-TABLE-UPDATE-001",
  "name": "Multiple Updates to Same Table",
  "description": "You are optimizing database performance. A violation occurs if a single transaction performs multiple separate updates or inserts to the *same* database table. This indicates inefficient code that should be batched (e.g., batchUpdate) to reduce network round-trips and lock contention.",
  "severity": "WARN",
  "category": "PERFORMANCE",
  "isEnabled": true,
  "detection": {
    "entryPoints": {
      "annotations": ["org.springframework.transaction.annotation.Transactional"],
      "types": [],
      "methodPatterns": []
    },
    "sinks": {
      "annotations": [],
      "types": [
        "org.springframework.jdbc.core.JdbcTemplate",
        "org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate"
      ],
      "methodPatterns": ["update", "batchUpdate", "insert"]
    },
    "pathConstraints": {
      "mustContain": [],
      "mustNotContain": [],
      "maxDepth": 20
    }
  },
  "remediation": {
    "quickFix": "Combine updates into a single batch operation or optimize the transaction scope.",
    "explanation": "Executing multiple separate updates on the same table increases database round-trips and lock contention. Consider batching or refining the logic.",
    "references": []
  }
}
